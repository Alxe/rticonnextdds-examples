# Flat Data API example

*CameraImage_publisher* and *CameraImage_subscriber* are simple applications using
the RTI FlatData language binding.

This example shows how to create, write, and read FlatData samples for a
mutable type.

The application is written in C++11 using the modern C++ API. However, 
the traditional C++ API supports FlatData as well.

For information about FlatData, see the RTI Connext DDS 
[User's Manual](https://community.rti.com/static/documentation/connext-dds/current/doc/manuals/connext_dds/html_files/RTI_ConnextDDS_CoreLibraries_UsersManual/index.htm#UsersManual/SendingLargeData.htm%3FTocPath%3DPart%25203%253A%2520Advanced%2520Concepts%7C22.%2520Sending%2520Large%2520Data%7C_____0) and the
[API Reference](https://community.rti.com/static/documentation/connext-dds/current/doc/api/connext_dds/api_cpp2/group__RTIFlatDataModule.html).

## Compiling the example

1) Use rtiddsgen to generate a makefile for your machine's architecture 
and compiler. For example:

```bash
rtiddsgen -language C++11 -example x64Darwin17clang9.0 CameraImage.idl
```

The option **-language C++11** is required.

You may get messages saying that some files already exist and will not be replaced. 
You can safely ignore those messages, since all the source files for this example 
are already provided.

2) Compile the Publisher and Subscriber apps:

```bash
make -f <makefile_for_your_platform>
```

The executables *CameraImage_publisher* and *CameraImage_subscriber* are located 
under **objs/\<architecture\>**

## Running the example

```
Usage: ./objs/x64Darwin17clang9.0/CameraImage_[publisher|subscriber] [domain_id] [sample_count]
```

## Exploring the code

`CameraImage.idl` defines the mutable FlatData type `CameraImage`.

`CameraImage_publisher.cxx` shows how to use the FlatData language binding to
populate a sample. See `build_data_sample()` and `build_data_sample_fast()`. The
rest is the typical code to create a `DataWriter` and write the data sample, as automatically
generated by *rtiddsgen*.

`CameraImage_subscriber.cxx` shows how to access the data from a FlatData sample
received by a DataReader. See `print_average_pixel_simple()` and 
`print_average_pixel_fast()`. The rest is the *rtiddsgen*-generated code to
create a `DataReader` and read data samples.

