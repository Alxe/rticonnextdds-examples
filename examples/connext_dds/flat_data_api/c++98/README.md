# Example Code: Flat Data API example

This example shows how to use FlatData in the RTI Connext DDS _Traditional C++ API_. 
For an example using the _Modern C++ API_, see ../c++11.

**Important:** A known issue in the _Traditional C++ API_ affects this example.
The function `build_data_sample_fast` in CameraImage_publisher.cxx cannot be used
without a fix. Contact support@rti.com to get access to this fix.

## Exploring the code

### CameraImage.idl

`CameraImage.idl` defines the mutable FlatData type `CameraImage`.

### CameraImage_publisher.cxx and CameraImage_subscriber.cxx

`CameraImage_publisher.cxx` shows how to use the FlatData language binding to
populate a sample. See `build_data_sample()` and `build_data_sample_fast()`.
The rest is the typical code to create a `DataWriter` and write the data
sample, as automatically generated by *rtiddsgen*.

`CameraImage_subscriber.cxx` shows how to access the data from a FlatData
sample received by a DataReader. See `print_average_pixel_simple()` and
`print_average_pixel_fast()`. The rest is the *rtiddsgen*-generated code to
create a `DataReader` and read data samples.

## Building C++98 Example

First, use rtiddsgen to generate a makefile for your machine's architecture and
compiler. For example:

```bash
rtiddsgen -language C++ -example <your_target_architecture> CameraImage.idl
```

The option **-language C++** is required.

You may get messages saying that some files already exist and will not be
replaced. You can safely ignore those messages, since all the source files
for this example are already provided.

Next, compile the Publisher and Subscriber apps:

```bash
make -f <makefile_for_your_target_architecture>
```

The executables *CameraImage_publisher* and *CameraImage_subscriber* are located
under **objs/\<architecture\>**

## Running C++98 Example

```plain
Usage: ./objs/<architecture>/CameraImage_[publisher|subscriber] [domain_id] [sample_count]
```
