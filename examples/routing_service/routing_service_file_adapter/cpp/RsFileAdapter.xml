<?xml version="1.0"?>
<dds xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="https://community.rti.com/schema/6.0.0/rti_routing_service.xsd">

    <types>
        <struct name="TestType">
            <member name="id" type="int32" key="true"/>
            <member name="message" stringMaxLength="128" type="string"/>
        </struct>
    </types>

    <plugin_library name="AdapterLib">
        <adapter_plugin name="FileAdapter">
            <!--
            By specifing this value, RTI Router will search for
            libstructarraytransf.so in Unix systems and structarraytransf.dll on
            Windows systems. RTI Routing Service will attempt to load this
            library from:
                - Working directory or plugin_search_path
                - Executable directory
                - Environment library path
            -->
            <dll>fileadapter</dll>
            <create_function>FileAdapter_create_adapter_plugin</create_function>
        </adapter_plugin>
    </plugin_library>

    <routing_service name="RSFileAdapter">
        <domain_route name="FileBridge">
            <connection name="FileConnection" plugin_name="AdapterLib::FileAdapter">
                <registered_type name="TestType" type_name="TestType"/>
            </connection>
            <session name="session">
                <route>
                    <route_types>false</route_types>
                    <input connection="FileConnection">
                        <creation_mode>ON_DOMAIN_MATCH</creation_mode>
                        <registered_type_name>TestType</registered_type_name>
                        <stream_name>TestTopic</stream_name>
                        <property>
                            <value>
                                <element>
                                    <name>example.adapter.input_file</name>
                                    <value>samples_in.csv</value>
                                </element>
                            </value>
                        </property>
                    </input>
                    <output connection="FileConnection">
                        <creation_mode>ON_DOMAIN_MATCH</creation_mode>
                        <registered_type_name>TestType</registered_type_name>
                        <stream_name>TestTopic</stream_name>
                        <property>
                            <value>
                                <element>
                                    <name>example.adapter.output_file</name>
                                    <value>mytest_output.data</value>
                                </element>
                            </value>
                        </property>
                    </output>
                </route>
            </session>
        </domain_route>
    </routing_service>
</dds>
